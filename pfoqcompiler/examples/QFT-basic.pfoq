decl qft(a){
    a[0] *= H;
    call rot(a);
    call shift(a);
    call qft(a-[-1]);
}

decl shift(b){
    if(|b|>1)then{
        SWAP(b[0],b[-1]);
        call shift(b-[-1]);
    }else{skip;}
}

decl rot(c){
    if(|c99999|>1)then{
        qcase(c99999[-1]) of {
            0->skip;,
            1->c99999[0] *= Ph(|c99999|);
        }
    call rot(c99999-[-1]);
    }else{skip;}
}
::
define q;
::
call qft(q);
