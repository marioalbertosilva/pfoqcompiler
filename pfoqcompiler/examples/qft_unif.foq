decl qft(a){
    a[0] *= H;
    call rot(a);
    call qft(a-[0]); }

decl invert(a){
    if(|a|>=2)then{
        SWAP(a[0],a[-1]);
        call invert(a-[0,-1]); } }

decl rot(a){
    if(|a|>=2)then{
        qcase(a[-1]) of {
            0-> skip;,
            1-> a[0] *= Ph[lambda x:pi/(2**x)](|a|-1);
        }
    call rot(a-[-1]); } }
::
define q;
::
call qft(q);
call invert(q);
